(()=>{"use strict";var t={964:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".form-row{display:flex;align-items:center;height:30px;gap:.5rem}.form-row:nth-child(2){margin-bottom:10px}.btn{height:25px;padding:3px;text-transform:uppercase}.btn-header{width:100px;margin:30px 10px 50px 0}.btn-pagination{margin:20px 10px 0 0}.form__input{height:19px}.form__input__color{height:25px}.table-winners{display:grid;grid-template-columns:1fr 1fr 2fr 1fr 1fr;justify-items:stretch;width:490px;border-top:1px solid #000;border-left:1px solid #000}.table-winners-header{font-weight:bold}.table-winners>div{padding-left:5px;text-align:center;border-bottom:1px solid #000;border-right:1px solid #000}.track-container{margin-bottom:15px}.track-container *{margin-right:5px}.track{position:relative;margin:5px 0 5px 0;height:40px;border-bottom:1px dashed}.track__car{position:absolute;display:inline-block;left:50px}.track__finish{position:absolute;right:100px;height:30px;bottom:1px}.drive{transition:5s}.popup{position:fixed;display:flex;align-items:center;justify-content:center;top:50%;left:50%;transform:translate(-50%);font-size:2em;background-color:rgba(0,0,0,.103)}.popup__text{background-color:#faebd7}.hide{display:none}",""]);const s=r},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(r[a]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);n&&r[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),e.push(c))}},e}},181:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n='<svg fill="#000000" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="60px" height="60px" viewBox="0 0 99.38 99.38" xml:space="preserve" transform="matrix(-1, 0, 0, 1, 0, 0)"> <g id="SVGRepo_bgCarrier" stroke-width="0"/> <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/> <g id="SVGRepo_iconCarrier"> <g> <g> <path d="M17.001,49.693c-4.12,0-7.46,3.338-7.46,7.459c0,0.319,0.026,0.631,0.066,0.938c0.462,3.677,3.593,6.521,7.394,6.521 c3.906,0,7.105-3.002,7.429-6.823c0.019-0.211,0.032-0.422,0.032-0.638C24.463,53.031,21.123,49.693,17.001,49.693z M13.264,54.342l1.522,1.521c-0.119,0.203-0.211,0.423-0.271,0.656H12.37C12.483,55.706,12.794,54.967,13.264,54.342z M12.364,57.812h2.16c0.062,0.229,0.15,0.447,0.27,0.646l-1.524,1.524C12.798,59.361,12.479,58.62,12.364,57.812z M16.356,61.787 c-0.809-0.111-1.543-0.429-2.164-0.896l1.517-1.518c0.199,0.116,0.418,0.201,0.647,0.262V61.787z M16.356,54.672 c-0.235,0.062-0.455,0.153-0.66,0.274l-1.521-1.521c0.625-0.475,1.366-0.788,2.181-0.901V54.672z M17.647,52.524 c0.813,0.113,1.555,0.428,2.18,0.902l-1.52,1.52c-0.205-0.121-0.426-0.214-0.66-0.274V52.524z M17.647,61.786v-2.151 c0.229-0.061,0.447-0.146,0.646-0.264l1.519,1.52C19.191,61.357,18.456,61.675,17.647,61.786z M20.738,59.988l-1.53-1.531 c0.118-0.199,0.217-0.414,0.278-0.646h2.144C21.516,58.62,21.21,59.367,20.738,59.988z M19.487,56.52 c-0.061-0.233-0.152-0.453-0.271-0.656l1.522-1.521c0.471,0.625,0.782,1.364,0.894,2.179L19.487,56.52L19.487,56.52z"/> <path d="M78.611,49.758c-4.103,0-7.428,3.324-7.428,7.428c0,0.317,0.025,0.627,0.064,0.934c0.46,3.66,3.578,6.494,7.363,6.494 c3.889,0,7.074-2.989,7.396-6.794c0.019-0.21,0.032-0.42,0.032-0.634C86.04,53.082,82.715,49.758,78.611,49.758z M74.891,54.387 l1.516,1.516c-0.118,0.202-0.21,0.421-0.27,0.653h-2.136C74.112,55.744,74.422,55.009,74.891,54.387z M73.994,57.842h2.15 c0.062,0.229,0.15,0.444,0.269,0.644l-1.519,1.52C74.427,59.386,74.108,58.646,73.994,57.842z M77.969,61.801 c-0.805-0.112-1.535-0.429-2.154-0.896l1.51-1.51c0.198,0.115,0.417,0.201,0.645,0.26V61.801z M77.969,54.715 c-0.233,0.061-0.453,0.152-0.656,0.272l-1.514-1.514c0.622-0.471,1.36-0.784,2.17-0.897V54.715z M79.255,52.576 c0.812,0.113,1.549,0.428,2.17,0.898l-1.513,1.513c-0.204-0.12-0.423-0.213-0.657-0.272V52.576z M79.255,61.8v-2.145 c0.229-0.059,0.446-0.146,0.645-0.262l1.511,1.512C80.792,61.371,80.061,61.687,79.255,61.8z M82.332,60.009l-1.523-1.524 c0.117-0.199,0.216-0.412,0.276-0.643h2.134C83.106,58.646,82.802,59.389,82.332,60.009z M81.087,56.555 c-0.06-0.232-0.15-0.451-0.27-0.653l1.516-1.516c0.469,0.622,0.778,1.357,0.889,2.169H81.087z"/> <path d="M99.352,52.001c-0.026-0.983-0.331-1.941-0.882-2.759l-0.402-0.6l-1.757-4.635c-0.331-0.875-1.139-1.484-2.07-1.562 c-1.728-0.146-4.663-0.368-7.465-0.471c-9.794-5.201-27.904-10.43-43.262-4.731c-3.151,1.169-12.154,5.744-12.154,5.744 s-14.62-0.37-25.047,3.349c-4.108,1.465-6.699,5.543-6.266,9.884c0.087,0.869,0.215,1.642,0.341,2.266 c0.199,0.987,1.014,1.731,2.015,1.842l6.487,0.711c-0.408-0.852-0.695-1.773-0.818-2.755c-0.052-0.401-0.078-0.772-0.078-1.132 c0-4.967,4.041-9.008,9.008-9.008c4.968,0,9.01,4.042,9.01,9.008c0,0.26-0.017,0.514-0.038,0.768 c-0.095,1.115-0.399,2.172-0.868,3.135h45.045l0.365-0.021c-0.4-0.842-0.683-1.753-0.804-2.72 c-0.052-0.403-0.077-0.773-0.077-1.127c0-4.95,4.026-8.978,8.977-8.978s8.978,4.026,8.978,8.978c0,0.259-0.017,0.511-0.038,0.764 c-0.062,0.734-0.223,1.438-0.453,2.11L88.112,60l6.979-0.923c1.214-0.161,2.285-0.876,2.898-1.936l0.695-1.199 c0.479-0.83,0.721-1.777,0.695-2.735L99.352,52.001z M74.63,43.068H40.469c0,0,0.203-0.809-0.69-1.786 c0,0,8.733-5.633,22.22-4.226c3.711,0.388,8.246,0.651,14.42,3.86L74.63,43.068z"/> </g> </g> </g> </svg> '},291:(t,e,i)=>{i.r(e),i.d(e,{default:()=>a});var n=i(379),r=i.n(n),s=i(964);r()(s.Z,{insert:"head",singleton:!1});const a=s.Z.locals||{}},379:(t,e,i)=>{var n,r=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),s=[];function a(t){for(var e=-1,i=0;i<s.length;i++)if(s[i].identifier===t){e=i;break}return e}function o(t,e){for(var i={},n=[],r=0;r<t.length;r++){var o=t[r],c=e.base?o[0]+e.base:o[0],l=i[c]||0,h="".concat(c," ").concat(l);i[c]=l+1;var d=a(h),u={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(s[d].references++,s[d].updater(u)):s.push({identifier:h,updater:f(u,e),references:1}),n.push(h)}return n}function c(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var s=i.nc;s&&(n.nonce=s)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var a=r(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var l,h=(l=[],function(t,e){return l[t]=e,l.filter(Boolean).join("\n")});function d(t,e,i,n){var r=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=h(e,r);else{var s=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function u(t,e,i){var n=i.css,r=i.media,s=i.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,m=0;function f(t,e){var i,n,r;if(e.singleton){var s=m++;i=p||(p=c(e)),n=d.bind(null,i,s,!1),r=d.bind(null,i,s,!0)}else i=c(e),n=u.bind(null,i,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=o(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var r=a(i[n]);s[r].references--}for(var c=o(t,e),l=0;l<i.length;l++){var h=a(i[l]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}i=c}}}},178:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=n(i(158)),s=n(i(186)),a=n(i(872));e.default=class{constructor(){this.header=new a.default,this.garage=new r.default,this.winners=new s.default}init(){this.header.init(),this.garage.init(),this.winners.init(),this.header.btnGarage.onclick=()=>{this.garage.wrapper.style.display="block",this.winners.wrapper.style.display="none"},this.header.btnWinners.onclick=()=>{this.garage.wrapper.style.display="none",this.winners.wrapper.style.display="block",this.winners.showTable()}}}},872:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(823);e.default=class{constructor(){const t=(0,n.createHtmlElement)(document.body,"header");this.btnGarage=(0,n.createHtmlElement)(t,"button","btn","garage"),this.btnWinners=(0,n.createHtmlElement)(t,"button","btn","winners")}init(){this.btnGarage.classList.add("btn-header"),this.btnWinners.classList.add("btn-header")}}},585:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(823);e.default=class{constructor(t,e,i=10){this.disabledButtons=!1,this.numPage=1,this.limitPage=i,this.countPages=1,this.countElements=0,this.cbRenderPage=e;const r=(0,n.createHtmlElement)(t,"div","pagination");this.btnPrev=(0,n.createHtmlElement)(r,"button","btn","Prev"),this.btnNext=(0,n.createHtmlElement)(r,"button","btn","Next")}init(){this.btnPrev.classList.add("btn-pagination"),this.btnNext.classList.add("btn-pagination"),this.btnNext.onclick=()=>this.nextPage(),this.btnPrev.onclick=()=>this.prevPage()}updateEnabled(){this.disabled?(this.btnNext.disabled=!0,this.btnPrev.disabled=!0):(this.btnNext.disabled=this.numPage===this.countPages,this.btnPrev.disabled=1===this.numPage)}get disabled(){return this.disabledButtons}set disabled(t){this.disabledButtons=t,this.updateEnabled()}setParam(t){this.countElements!==t&&(this.countElements=t,this.countPages=Math.ceil(this.countElements/this.limitPage),this.updateEnabled())}nextPage(){this.numPage>=this.countPages||(this.numPage+=1,this.updateEnabled(),this.cbRenderPage())}prevPage(){this.numPage<=1||(this.numPage-=1,this.updateEnabled(),this.cbRenderPage())}}},319:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(823);e.default=class{constructor(t){this.wrapper=(0,n.createHtmlElement)(t,"div","popup"),this.span=(0,n.createHtmlElement)(this.wrapper,"span","popup__text")}init(){this.hide()}show(t,e){this.span.textContent=`The winner is ${t}: ${e.toFixed(3)} sec.`,this.wrapper.classList.contains("hide")&&this.wrapper.classList.remove("hide")}hide(){this.wrapper.classList.contains("hide")||this.wrapper.classList.add("hide")}}},186:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(823),a=i(232),o=r(i(781)),c=r(i(956)),l=r(i(585)),h=r(i(181));e.default=class{constructor(){this.sort=a.SortWinners.Id,this.order=a.Order.Asc,this.wrapper=(0,s.createHtmlElement)(document.body,"section","winners"),this.title=(0,s.createHtmlElement)(this.wrapper,"h2","","Winners (10)"),this.titlePage=(0,s.createHtmlElement)(this.wrapper,"h4","","Page #1"),this.tableWinners=(0,s.createHtmlElement)(this.wrapper,"div","table-winners"),this.svgCar=document.createElement("svg"),this.paginator=new l.default(this.wrapper,this.showTable.bind(this)),this.api=new c.default,this.apiGarage=new o.default}init(){this.svgCar.innerHTML=h.default,this.svgCar=this.svgCar.children.item(0),this.paginator.init(),this.wrapper.style.display="none"}showTable(){return n(this,void 0,void 0,(function*(){const t=yield this.api.getWinners(this.paginator.numPage,this.paginator.limitPage,this.sort,this.order);this.paginator.countElements!==t.count&&(this.paginator.setParam(t.count),this.setTitle()),this.renderWinners(t.winners)}))}renderWinners(t){return n(this,void 0,void 0,(function*(){this.setNumPage(),this.tableWinners.innerHTML="",this.addRowHeader();const e=yield Promise.all(t.map((({id:t})=>this.apiGarage.getCar(t))));t.forEach(((t,i)=>this.addRow(i+1,t,e[i])))}))}addRowHeader(){["number","Car","Name","Wins","Best time (seconds)"].forEach((t=>{const e=(0,s.createHtmlElement)(this.tableWinners,"div","table-winners-header");if(["Wins","Best time (seconds)"].includes(t)){const i=(0,s.createHtmlElement)(this.tableWinners,"a","table-winners-order",t);e.append(i),i.href="#",i.dataset.name=t,t.includes("time")&&(i.dataset.name="time"),i.onclick=t=>{t.preventDefault();const e=t.target.dataset.name.toLowerCase();this.sort===e?this.order=this.order===a.Order.Asc?a.Order.Desc:a.Order.Asc:this.sort=e,this.showTable()}}else e.textContent=t}))}addRow(t,e,i){const n=this.svgCar.cloneNode(!0);n.style.fill=i.color,n.style.height="40px",(0,s.createHtmlElement)(this.tableWinners,"div","",String(t));const r=(0,s.createHtmlElement)(this.tableWinners,"div");(0,s.createHtmlElement)(this.tableWinners,"div","",i.name),(0,s.createHtmlElement)(this.tableWinners,"div","",String(e.wins)),(0,s.createHtmlElement)(this.tableWinners,"div","",String(e.time.toFixed(3))),r.append(n)}setTitle(){this.title.textContent=`Winners (${this.paginator.countElements})`}setNumPage(){this.titlePage.textContent=`Page #(${this.paginator.numPage})`}}},726:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const r=i(240),s=i(927);e.default=class{constructor(){this.path=`${r.URL}/${s.Path.Engine}`}setStatusEngine(t,e){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}?id=${t}&status=${e}`,{method:s.Method.PATCH})).json()}))}setStatusEngineDrive(t){return n(this,void 0,void 0,(function*(){const e=yield fetch(`${this.path}?id=${t}&status=drive`,{method:s.Method.PATCH});return e.status<200||e.status>299?{success:!1}:e.json()}))}}},781:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const r=i(240),s=i(927);e.default=class{constructor(){this.path=`${r.URL}/${s.Path.Garage}`}getCar(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}/${t}`)).json()}))}getCars(t,e){var i;return n(this,void 0,void 0,(function*(){const n=yield fetch(`${this.path}?_page=${t}&_limit=${e}`),r=null!==(i=n.headers.get("X-Total-Count"))&&void 0!==i?i:0;return{cars:yield n.json(),count:Number(r)}}))}createCar(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}`,{method:s.Method.POST,body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}))}updateCar(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}/${t.id}`,{method:s.Method.PUT,body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}))}deleteCar(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}/${t}`,{method:s.Method.DELETE,headers:{"Content-type":"application/json"}})).json()}))}}},956:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const r=i(240),s=i(927);e.default=class{constructor(){this.path=`${r.URL}/${s.Path.Winners}`}getWinners(t,e,i,r){var s;return n(this,void 0,void 0,(function*(){const n=yield fetch(`${this.path}?_page=${t}&_limit=${e}&_sort=${i}&_order=${r}`),a=null!==(s=n.headers.get("X-Total-Count"))&&void 0!==s?s:0;return{winners:yield n.json(),count:Number(a)}}))}getWinner(t){return n(this,void 0,void 0,(function*(){const e=yield fetch(`${this.path}/${t}`);return e.status<200||e.status>299?{id:t,wins:0,time:0}:e.json()}))}createWinner(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}`,{method:s.Method.POST,body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}))}updateWinner(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}/${t.id}`,{method:s.Method.PUT,body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}))}deleteWinner(t){return n(this,void 0,void 0,(function*(){return(yield fetch(`${this.path}/${t}`,{method:s.Method.DELETE,headers:{"Content-type":"application/json"}})).json()}))}}},927:(t,e)=>{var i,n;Object.defineProperty(e,"__esModule",{value:!0}),e.Method=e.Path=void 0,function(t){t.Garage="garage",t.Engine="engine",t.Winners="winners"}(i||(e.Path=i={})),function(t){t.POST="POST",t.GET="GET",t.PATCH="PATCH",t.PUT="PUT",t.DELETE="DELETE"}(n||(e.Method=n={}))},959:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(823);e.default=class{constructor(t){const e=(0,n.createHtmlElement)(t,"section","form-car"),i=(0,n.createHtmlElement)(e,"div","form-row");this.inputNameCreate=(0,n.createHtmlElement)(i,"input","form__input"),this.inputColorCreate=(0,n.createHtmlElement)(i,"input","form__inpur__color"),this.inputColorCreate.type="color",this.btnCreate=(0,n.createHtmlElement)(i,"button","btn","Create car");const r=(0,n.createHtmlElement)(e,"div","form-row");this.inputNameUpdate=(0,n.createHtmlElement)(r,"input","form__input"),this.inputColorUpdate=(0,n.createHtmlElement)(r,"input","form__inpur__color"),this.inputColorUpdate.type="color",this.btnUpdate=(0,n.createHtmlElement)(r,"button","btn","Update car");const s=(0,n.createHtmlElement)(e,"div","form-row");this.btnRace=(0,n.createHtmlElement)(s,"button","btn","Race"),this.btnReset=(0,n.createHtmlElement)(s,"button","btn","Reset"),this.btnGenerate=(0,n.createHtmlElement)(s,"button","btn","Generate")}init(){this.btnUpdate.disabled=!0}setCb(t,e){this.btnCreate.onclick=()=>this.createCar(t),this.btnUpdate.onclick=()=>this.updateTrack(e)}createCar(t){const e={id:0,name:"",color:""};e.name=this.inputNameCreate.value,e.color=this.inputColorCreate.value,t(e),this.inputNameCreate.value="",this.inputColorCreate.value="#000000"}selectTrack(t){this.btnUpdate.disabled=!1,this.track=t,this.inputNameUpdate.value=t.car.name,this.inputColorUpdate.value=t.car.color}updateTrack(t){this.track&&(this.track.setName(this.inputNameUpdate.value),this.track.setColor(this.inputColorUpdate.value),t(this.track.car)),this.inputNameUpdate.value="",this.inputColorUpdate.value="#000000",this.track=void 0,this.btnUpdate.disabled=!0}}},158:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(823),s=n(i(959)),a=n(i(911));e.default=class{constructor(){this.wrapper=(0,r.createHtmlElement)(document.body,"section","garage"),this.form=new s.default(this.wrapper),this.race=new a.default(this.wrapper,this.form)}init(){this.form.init(),this.race.init()}}},911:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(823),a=r(i(781)),o=r(i(956)),c=r(i(585)),l=r(i(133)),h=r(i(319));e.default=class{constructor(t,e){const i=(0,s.createHtmlElement)(t,"section","race");this.title=(0,s.createHtmlElement)(i,"h2","","Garage (100)"),this.titlePage=(0,s.createHtmlElement)(i,"h4","","Page #1"),this.wrapperTrack=(0,s.createHtmlElement)(i,"div","tracks"),this.raceStarted=!1,this.timeMin=0,this.tracks=[],this.form=e,this.api=new a.default,this.apiWinners=new o.default,this.paginator=new c.default(i,this.showRace.bind(this),7),this.popup=new h.default(i)}init(){this.paginator.init(),this.popup.init(),this.form.setCb(this.createCar.bind(this),this.updateCar.bind(this)),this.form.btnRace.onclick=()=>this.race(),this.form.btnReset.onclick=()=>this.reset(),this.form.btnGenerate.onclick=()=>this.generate(),this.showRace()}showRace(){return n(this,void 0,void 0,(function*(){const t=yield this.api.getCars(this.paginator.numPage,this.paginator.limitPage);this.paginator.countElements!==t.count&&(this.paginator.setParam(t.count),this.setTitle()),this.renderTracks(t.cars)}))}renderTracks(t){this.tracks=[],this.setNumPage(),this.wrapperTrack.innerHTML="",t.forEach((t=>this.renderTrack(t)))}renderTrack(t){const e=new l.default(this.wrapperTrack,t.id,t.name,t.color);e.init(this.form.selectTrack.bind(this.form),this.removeCar.bind(this),this.callFinish.bind(this)),this.tracks.push(e)}setTitle(){this.title.textContent=`Garage (${this.paginator.countElements})`}setNumPage(){this.titlePage.textContent=`Page #(${this.paginator.numPage})`}createCar(t){return n(this,void 0,void 0,(function*(){yield this.api.createCar(t),this.showRace()}))}updateCar(t){return n(this,void 0,void 0,(function*(){yield this.api.updateCar(t),this.showRace()}))}removeCar(t){return n(this,void 0,void 0,(function*(){yield this.api.deleteCar(t),yield this.apiWinners.deleteWinner(t),this.showRace()}))}race(){this.raceStarted=!0,this.timeMin=0,this.tracks.forEach((t=>{t.setCarDrive(!0)})),this.form.btnRace.disabled=!0,this.form.btnReset.disabled=!0,this.paginator.disabled=!0}reset(){return n(this,void 0,void 0,(function*(){this.form.btnReset.disabled=!0,yield Promise.all(this.tracks.map((t=>t.setCarInit()))),this.form.btnRace.disabled=!1,this.paginator.disabled=!1,this.popup.hide()}))}generate(){const t={id:0,name:"",color:""};for(let e=0;e<100;e+=1)t.name=(0,s.getRandomName)(),t.color=(0,s.getRandomColor)(),this.api.createCar(t);this.showRace()}callFinish(t){return n(this,void 0,void 0,(function*(){if(this.raceStarted&&!this.timeMin){this.form.btnReset.disabled=!1,this.popup.show(t.car.name,t.finishTime),this.timeMin=t.finishTime;const e=yield this.apiWinners.getWinner(t.car.id),i=!e.wins;e.wins+=1,(!e.time||e.time>this.timeMin)&&(e.time=this.timeMin),i?yield this.apiWinners.createWinner(e):yield this.apiWinners.updateWinner(e)}}))}}},133:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}c((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(823),a=r(i(181)),o=r(i(726));e.default=class{constructor(t,e,i,n){const r=(0,s.createHtmlElement)(t,"div","track-container"),a=(0,s.createHtmlElement)(r,"div","track__controls");this.btnSelect=(0,s.createHtmlElement)(a,"button","btn","Select"),this.btnRemove=(0,s.createHtmlElement)(a,"button","btn","Remove"),this.spanNameCar=(0,s.createHtmlElement)(a,"span","",i),this.wrapperTrack=(0,s.createHtmlElement)(r,"div","track"),this.btnA=(0,s.createHtmlElement)(this.wrapperTrack,"button","btn","A"),this.btnB=(0,s.createHtmlElement)(this.wrapperTrack,"button","btn","B"),this.wrapperImgCar=(0,s.createHtmlElement)(this.wrapperTrack,"div","track__car"),this.imgCar=document.createElement("svg"),this.imgFinish=(0,s.createHtmlElement)(this.wrapperTrack,"img","track__finish"),this.apiCarEvents=new o.default,this.cbFinish=()=>{},this.finishTime=0,this.car={id:e,name:i,color:n},this.engine={status:"stopped",velocity:0,distance:0}}init(t,e,i){this.initSvg(),this.imgFinish.src="dist/finish.jpg",this.btnB.disabled=!0,this.btnSelect.onclick=()=>t(this),this.btnRemove.onclick=()=>e(this.car.id),this.btnA.onclick=()=>this.setCarDrive(),this.btnB.onclick=()=>this.setCarInit(),this.cbFinish=i}initSvg(){this.wrapperImgCar.innerHTML=a.default,this.imgCar=this.wrapperImgCar.children[0],this.setColor(this.car.color)}setName(t){this.car.name=t,this.spanNameCar.textContent=t}setColor(t){this.car.color=t,this.imgCar.style.fill=t}setCarDrive(t=!1){return n(this,void 0,void 0,(function*(){this.finishTime=0,this.engine.status="started",this.btnA.disabled=!0,this.btnSelect.disabled=!0,this.btnRemove.disabled=!0;const e=yield this.apiCarEvents.setStatusEngine(this.car.id,this.engine.status);this.engine.distance=e.distance,this.engine.velocity=e.velocity,this.engine.status="drive";const i=e.distance/e.velocity;this.startAnimation(i),this.btnB.disabled=t,(yield this.apiCarEvents.setStatusEngineDrive(this.car.id)).success||(this.engine.status="stopped")}))}setCarInit(){return n(this,void 0,void 0,(function*(){yield this.apiCarEvents.setStatusEngine(this.car.id,"stopped"),this.engine.status="stopped",this.wrapperImgCar.style.transform="",this.btnA.disabled=!1,this.btnB.disabled=!0,this.btnSelect.disabled=!1,this.btnRemove.disabled=!1}))}startAnimation(t){let e=0,i=0;const n=document.body.clientWidth-150,r=n/(t/(1e3/60)),s=t=>{e||(e=t),i+=r;const a=t-e;"drive"===this.engine.status&&(this.wrapperImgCar.style.transform=`translateX(${i}px)`),i<n&&"drive"===this.engine.status?requestAnimationFrame(s):i>=n&&(this.finishTime=a/1e3,this.cbFinish(this))};requestAnimationFrame(s)}}},240:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MODEL_CAR=e.NAMES_CAR=e.URL=void 0,e.URL="http://127.0.0.1:3000",e.NAMES_CAR=["AUDI","BMW","MERCEDES","GEELY","LADA","TOYOTA","NISSAN","HONDA","SUBARU","TESLA"],e.MODEL_CAR=["Q3","Q5","Q7","X1","X3","X5","X7","ML","E200","S500","EMGRAND","XRAY","LC200","SUPRA","X-TRAIL","CRV","CIVIC","IMPREZA","MODEL X","MODEL Y"]},232:(t,e)=>{var i,n;Object.defineProperty(e,"__esModule",{value:!0}),e.Order=e.SortWinners=void 0,function(t){t.Id="id",t.Wins="wins",t.Time="time"}(i||(e.SortWinners=i={})),function(t){t.Asc="ASC",t.Desc="Desc"}(n||(e.Order=n={}))},607:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),i(291),(new(n(i(178)).default)).init()},823:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRandomName=e.getRandomColor=e.createHtmlElement=e.createElement=void 0;const n=i(240);function r(t,e,i="",n=""){const r=document.createElement(e);return i&&r.classList.add(i),n&&(r.textContent=n),t&&t.append(r),r}e.createElement=r,e.createHtmlElement=function(t,e,i="",n=""){return r(t,e,i,n)},e.getRandomColor=function(){let t="#";for(let e=0;e<6;e+=1)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},e.getRandomName=function(){return`${n.NAMES_CAR[Math.floor(Math.random()*n.NAMES_CAR.length)]} ${n.MODEL_CAR[Math.floor(Math.random()*n.MODEL_CAR.length)]}`}}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={id:n,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nc=void 0,i(607)})();